<html>
<head>
<title> CS585 Homework Template: HW4 Alex Wong  </title>
<style>
<!--
body{
font-family: 'Trebuchet MS', Verdana;
}
p{
font-family: 'Trebuchet MS', Times;
margin: 10px 10px 15px 20px;
}
h4{
    margin: 15px;
}
h3{
margin: 10px;
}
h2{
margin: 10px;
}
h1{
margin: 10px 0px 0px 20px;
}
div.main-body{
align:center;
margin: 30px;
}
hr{
margin:20px 0px 20px 0px;
}
.img-face{
width:50%
}
.tg {
    border-collapse: collapse;
    border-spacing: 0;
}

.tg td {
    font-family: Arial, sans-serif;
    font-size: 14px;
    padding: 10px 5px;
    border-style: solid;
    border-width: 1px;
    overflow: hidden;
    word-break: normal;
    border-color: black;
}

.tg th {
    font-family: Arial, sans-serif;
    font-size: 14px;
    font-weight: normal;
    padding: 10px 5px;
    border-style: solid;
    border-width: 1px;
    overflow: hidden;
    word-break: normal;
    border-color: black;
}

.tg .tg-ted4 {
    border-color: #333333;
    text-align: center;
    vertical-align: middle;
}

-->
</style>
</head>

<body>
<center>
<a href="http://www.bu.edu"><img border="0" src="http://www.cs.bu.edu/fac/betke/images/bu-logo.gif"
width="119" height="120"></a>
</center>

<h1>Assignment 4</h1>
<p> 
CS 585 HW 4<br>
Alex Wong, Wei-Hsiang Lin and Rahul Suresh<br>
March 24, 2020
</p>

<h1>Part 1</h1>
<div class="main-body">

<hr>
<h2>Problem Definition</h2>
<!-- TODO(R) -->
<p>>>The current problem involves the implementation of tracking algorithms. 
Specifically two datasets have been given, the bat dataset and the cell dataset. 
Multiple objects are present in each frame and have to be tracked. 
The assumptions we make are that the objects move only slightly between two frames. 
The anticipated difficulties are implementing a reliable tracking algorithm and obtaining correct segmentation data.<<</p>

<hr>
<h2>Method and Implementation </h2>
<h3>Multiple Object Tracking</h3>
<h4>Alpha-Beta Filtering</h4>
<!--TODO(R) - Implement an alpha-beta filter or using a third-party Kalman filter library and get good tracking results for simple situations (e.g. when objects move separately without occluding each other)-->
<p>>>For the tracking part, an alpha-beta tracker was implemented. The alpha beta observer is a simplified form of a linear state observer that assumes an object can be described by a model with 2 internal states. This system accounts for both process noise and measurement noise and is a lower order approximation.

The two internal states represented by the model are position and velocity. This tracker has a prediction phase where it predicts the position and velocity for this time step using knowledge from the previous time step. In then calculates the residual ( measurement for this time step - prediction) and uses it to update the position and the velocity weighed by the parameters  α,β  respectively.
<<</p>
<img src="./img/summary.png" class="img-face"/>
<p>>>Figure 1 : Algorithm summary<<</p>

<h4>Suboptimal Bipartite Matching Algorithm</h4>
<!-- TODO(R) - Implement a greedy, suboptimal bipartite matching algorithm -->
<p>>>Type Here<<</p>

<h4>Implementation Details</h4>
<!--TODO(A)
    - Display the tracking results on top of the original images. Use different colors to show that you successfully maintain track identity. Draw lines to show the history of the flight trajectories
    - Challenge 1: Proper handling of situations when objects touch and occlude each other
    - Challenge 2: Proper handling of the beginning of new tracks and the termination of old tracks as the objects enter and leave the field of view
How do you decide to begin new tracks and terminate old tracks as the objects enter and leave the field of view?
What happens with your algorithm when objects touch and occlude each other, and how could you handle this so you do not break track?
What happens when there are spurious detections that do not connect with other measurements in subsequent frames?

-->
<p>>>For our implementation the equations used were,
<<</p>
<img src="./img/equations.png" class="img-face"/>
<p>>>Figure 2 : Update equations<<</p>
<p>>>The values for α,β itself are hyperparameters. Typically, lower values of  α,β  reflect more belief on the prediction ( when there is more measurement noise ) and higher values reflect more belief on the measurement ( less measurement noise). 

All this was the alpha beta tracker for a single object. While extending to multiple objects the main problem was data association. Also all of the above parameters had to re-written as matrices and vectors. So all the update operations became vector operations. We implemented the greedy matching algorithm where older objects with longer tracking history were matched first. The gating used was a circular gate of 50 px. This was a trade off between recall and precision. 

The code was highly modularized and separate classes were created to perform the main tasks. The data_loader class was created to load all images, localization and segmentation maps. Different flags were provided to control what to load.

The bat_tracking class performed the actual bat tracking. The show_frame_wise methods ran the tracking. Different other helper functions were created to perform the other tasks. The create_color_hash function created the color hash to plot the tracks of the different bats. The draw_line function drew the bat tracks on the image. The update_velocity function performed the velocity updates. The update_coords function performed the position updates. The subtract function was used to calculate the residual vector. The association function performed the greedy data association.  This was the function that was tricky in our opinion. The distance function calculated the euclidean distance between two points and the get_x_pred function predicted the object coordinates of the next time step.
 
<<</p>


<h3>Segmentation/Localization</h3>
<h4>Cell Dataset</h4>
<!-- TODO(S) 
 - For cell dataset, implement a segmentation or detection algorithm to locate each cell.
 - Bonus: 1) detecting the birth of a new cell. 2) detecting migrating cells (i.e cells with filopodia). 3) handling the spurious detections (false positives). 4)trying different kinematic models. 
 - What are the advantages and drawbacks of different kinematic models: Do you need to model the velocity of the objects, or is it sufficient to just consider the distances between the objects in subsequent frames?
-->
<p>>>Type Here<<</p>

<hr>
<h2>Experiments</h2>
<!-- TODO(All) -->
<p>>>Type Here<<</p>

<hr>
<h2>Results</h2>
<!-- TODO(A) 
Display the results of your tracking algorithm on top of the original images. Use different colors to show that you successfully maintain track identity. Draw lines to show the history of the flight trajectories.
Show your tracking results on some portion of the sequence. In addition to showing your tracking results on an easy portion of the data, identify a challenging situation where your tracker succeeds, and a challenging situation where your tracker fails.

-->
<p>>>Type Here<<</p>

<!-- <table>
    <tr>
        <th>Open Hand</th>
        <th>Open Hand Partial</th>
        <th>Open Fist</th>
        <th>Tumor</th>
    </tr>
    <tr>
        <td style="width:25%"><img src="./img/p1/open-bw-full.png" class="img-face"/></td>
        <td style="width:25%"><img src="./img/p1/open-bw-partial.png" class="img-face"/></td>
        <td style="width:25%"><img src="./img/p1/open_fist-bw.png" class="img-face"/></td>
        <td style="width:25%"><img src="./img/p1/tumor-fold.png" class="img-face"/></td>
    </tr>
</table> -->

<hr>
<h2> Discussion</h2>
<!-- TODO(S) -->
<p>>>Type Here<<</p>

<hr>
<h2> Conclusion</h2>
<!-- TODO(S) -->
<p>>>Future work would definitely include using kalman filters and the optimal matching (hungarian) algorithm. MHT could also be tried.<<</p>

<hr>
<h2> Credits and Bibliography </h2>
<!-- TODO(S) -->
<p>>>Type Here<<</p>

</div>
</body>
</html>

